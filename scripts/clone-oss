#!/bin/bash
# clone-oss - OSS ãƒªãƒã‚¸ãƒˆãƒªã‚’ ~/Work/oss/ ã« clone
#
# ä½¿ã„æ–¹:
#   clone-oss <repo-url> [name]
#
# ä¾‹:
#   clone-oss https://github.com/danielmiessler/Personal_AI_Infrastructure PAI
#   clone-oss https://github.com/anthropics/claude-code
#
# PAI åŸå‰‡ #5: Code Before Prompts

set -e

DEST="${HOME}/Work/oss"

if [[ -z "$1" ]] || [[ "$1" == "-h" ]] || [[ "$1" == "--help" ]]; then
  echo "ä½¿ã„æ–¹: clone-oss <repo-url> [name]"
  echo ""
  echo "ä¾‹:"
  echo "  clone-oss https://github.com/user/repo"
  echo "  clone-oss https://github.com/user/repo custom-name"
  exit 1
fi

repo="$1"
name="${2:-$(basename "$repo" .git)}"

mkdir -p "$DEST"

if [[ -d "$DEST/$name" ]]; then
  echo "âš ï¸  $DEST/$name ã¯æ—¢ã«å­˜åœ¨"
  echo "   æ›´æ–°: cd $DEST/$name && git pull"
  exit 1
fi

echo "ğŸ“¦ Cloning to $DEST/$name ..."
cd "$DEST" && git clone --depth 1 "$repo" "$name"

echo ""
echo "âœ… $DEST/$name"
